<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Hello wasm-pack CN</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> æ¦‚è§ˆ</a></li><li class="chapter-item expanded "><a href="QuickStart.html"><strong aria-hidden="true">2.</strong> å¿«é€Ÿå¼€å§‹</a></li><li class="chapter-item expanded "><a href="commands/index.html"><strong aria-hidden="true">3.</strong> å‘½ä»¤</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="commands/new.html"><strong aria-hidden="true">3.1.</strong> new</a></li><li class="chapter-item expanded "><a href="commands/build.html"><strong aria-hidden="true">3.2.</strong> build</a></li><li class="chapter-item expanded "><a href="commands/test.html"><strong aria-hidden="true">3.3.</strong> test</a></li><li class="chapter-item expanded "><a href="commands/pack-and-publish.html"><strong aria-hidden="true">3.4.</strong> pack å’Œ publish</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Hello wasm-pack CN</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><img src="https://rustwasm.github.io/wasm-pack/public/img/wasm-ferris.png" alt="wasm ferris" /></p>
<h1 style="text-align: center;">æ¬¢è¿æ¥åˆ° <code>wasm-pack</code> æ–‡æ¡£!</h1>
<p>åŸæ–‡åœ°å€ <a href="https://rustwasm.github.io/docs/wasm-pack/">https://rustwasm.github.io/docs/wasm-pack/</a></p>
<p>æœ¬å·¥å…·æ—¨åœ¨æˆä¸ºä¸€ä¸ªåœ¨æµè§ˆå™¨ã€Node.js ç¯å¢ƒä¸­ä½¿ç”¨ Rust çš„ä¸€ç«™å¼å·¥å…·</p>
<p><code>wasm-pack</code> å¯ä»¥å°† Rust ä»£ç æ‰“åŒ…ä¸º WebAssembly npm åŒ…ã€‚
å¯ä»¥ä¸Šä¼ åˆ° npm ä»“åº“ï¼Œä¹Ÿå¯ä»¥é›†æˆè¿›ç°æœ‰çš„ JavaScript å·¥ä½œæµä¸­ï¼Œä¾‹å¦‚ <a href="https://webpack.js.org/">webpack</a></p>
<p>è¿™ä¸ªé¡¹ç›®æ˜¯ <a href="https://github.com/rustwasm/team">rust-wasm</a> çš„ä¸€éƒ¨åˆ†. ä½ å¯ä»¥åœ¨è¯¥é¡¹ç›®çš„ä»“åº“ä¸­äº†è§£åˆ°æ›´å¤šä¿¡æ¯</p>
<p><img src="https://github.com/rustwasm/wasm-pack/raw/master/demo.gif" alt="demo" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quickstart"><a class="header" href="#quickstart">Quickstart</a></h1>
<ol>
<li>ä½¿ç”¨ <a href="https://rustup.rs/"><code>rustup</code></a> å®‰è£… <code>rust</code></li>
<li>å®‰è£… <a href="https://rustwasm.github.io/wasm-pack/installer/"><code>wasm-pack</code></a></li>
<li>è¿è¡Œ <code>wasm-pack new hello-wasm</code></li>
<li><code>cd hello-wasm</code></li>
<li>è¿è¡Œ <code>wasm-pack build</code></li>
<li>è¿™å°†åœ¨ <code>pkg</code> æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆæ‰“åŒ…çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬ wasmã€js bridgeã€ts defines å’Œ package.json</li>
<li>å¦‚æœè¦ä¸Šä¼ åˆ° npm ä»“åº“ï¼Œå¯ä»¥è¿è¡Œ <code>wasm-pack publish</code>ã€‚å¦‚æœéœ€è¦ç™»å½•çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>wasm-pack login</code> æ¥ç™»å½• npm ä»“åº“</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å‘½ä»¤"><a class="header" href="#å‘½ä»¤">å‘½ä»¤</a></h1>
<p>åœ¨ä½¿ç”¨ <code>wasm-pack</code> çš„è¿‡ç¨‹ä¸­ï¼Œä¸‹é¢å‡ ä¸ªå‘½ä»¤å¯èƒ½ä¼šç”¨åˆ°ï¼š</p>
<ul>
<li><code>new</code>: ä½¿ç”¨å†…ç½®æ¨¡æ¿åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›® <a href="commands/./new.html">äº†è§£æ›´å¤š</a></li>
<li><code>build</code>: åœ¨ <code>pkg</code> ç›®å½•ä¸‹ç”Ÿæˆç¼–è¯‘åçš„ wasm æ–‡ä»¶å’Œ èƒ¶æ°´ js æ–‡ä»¶ <a href="commands/./build.html">äº†è§£æ›´å¤š</a></li>
<li><code>pack</code> å’Œ <code>publish</code>: åœ¨ <code>pkg</code> ç›®å½•ä¸‹ç”Ÿæˆ npm åŒ…ï¼Œå¹¶èƒ½å’Œ <code>npm</code> å‘½ä»¤ä¸€æ ·æ¨é€åˆ° npm ä»“åº“ <a href="commands/./pack-and-publish.html">äº†è§£æ›´å¤š</a></li>
</ul>
<h2 id="å·²ç»å¼ƒç”¨çš„å‘½ä»¤"><a class="header" href="#å·²ç»å¼ƒç”¨çš„å‘½ä»¤">å·²ç»å¼ƒç”¨çš„å‘½ä»¤</a></h2>
<ul>
<li><code>init</code>: è¯¥å‘½ä»¤å·²ç»è¢« <code>build</code> å‘½ä»¤æ‰€å–ä»£</li>
</ul>
<h2 id="æ—¥å¿—çº§åˆ«"><a class="header" href="#æ—¥å¿—çº§åˆ«">æ—¥å¿—çº§åˆ«</a></h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>wasm-pack</code> ä¼šè¾“å‡ºå¾ˆå¤šæœ‰ç”¨çš„æ¶ˆæ¯ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>--verbose</code> å‚æ•°æ¥è¾“å‡º<em>æ›´å¤š</em>çš„æ¶ˆæ¯ï¼Œæˆ–è€…ç”¨ <code>--quiet</code> å±è”½<em>æ‰€æœ‰</em>è¾“å‡ºã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>--log-level</code> å‚æ•°æ¥è®¾ç½®æ—¥å¿—çº§åˆ«ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å€¼ï¼š</p>
<ul>
<li><code>--log-level info</code> é»˜è®¤å€¼, ä¼šè¾“å‡ºæ‰€æœ‰çš„æ¶ˆæ¯.</li>
<li><code>--log-level warn</code> è¾“å‡ºè­¦å‘Šå’Œé”™è¯¯ï¼Œå•ä¸ä¼šè¾“å‡º info çº§åˆ«çš„æ¶ˆæ¯.</li>
<li><code>--log-level error</code> åªä¼šè¾“å‡ºé”™è¯¯æ¶ˆæ¯.</li>
</ul>
<p>æ—¥å¿—çº§åˆ«çš„æ ‡å¿—ä½æ˜¯å…¨å±€æ ‡å¿—ä½ï¼Œæ‰€ä»¥ä»–ä»¬éœ€è¦åœ¨å…·ä½“å‘½ä»¤<em>ä¹‹å‰</em>ä½¿ç”¨:</p>
<pre><code class="language-sh">wasm-pack --log-level error build
wasm-pack --quiet build
wasm-pack --verbose build
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wasm-pack-new"><a class="header" href="#wasm-pack-new">wasm-pack new</a></h1>
<p><code>wasm-pack new</code> å‘½ä»¤å°†ä¼šä¸ºä½ åˆ›å»ºä¸€ä¸ªæ–°çš„ RustWasm é¡¹ç›®ï¼Œå†…éƒ¨æ˜¯ä½¿ç”¨ <a href="https://github.com/ashleygwilliams/cargo-generate"><code>cargo-generate</code></a> å®ç°çš„ã€‚</p>
<p><code>new</code> å‘½ä»¤åŒ…å« 3 ä¸ªå‚æ•°,nameã€template å’Œ modeã€‚</p>
<pre><code class="language-sh">wasm-pack new &lt;name&gt; --template &lt;template&gt; --mode &lt;normal|noinstall|force&gt;
</code></pre>
<p>é»˜è®¤çš„æ¨¡æ¿æ˜¯ <a href="https://github.com/rustwasm/wasm-pack-template"><code>rustwasm/wasm-pack-template</code></a>.</p>
<h2 id="name"><a class="header" href="#name">Name</a></h2>
<p><code>wasm-pack new</code> å¿…é¡»æŒ‡å®šä¸€ä¸ªé¡¹ç›®åç§°:</p>
<pre><code class="language-sh">wasm-pack new myproject
</code></pre>
<h2 id="template"><a class="header" href="#template">Template</a></h2>
<p><code>wasm-pack new</code> å¯ä»¥ç”¨ <code>--template</code> å‚æ•°æŒ‡å®šä¸€ä¸ªæ¨¡æ¿:</p>
<pre><code class="language-sh">wasm-pack new myproject --template https://github.com/rustwasm/wasm-pack-template
</code></pre>
<p>æ¨¡æ¿éœ€è¦æ˜¯ä¸€ä¸ªå®ç°äº† <a href="https://github.com/ashleygwilliams/cargo-generate"><code>cargo-generate</code></a> çš„ git ä»“åº“åœ°å€ã€‚</p>
<h2 id="mode"><a class="header" href="#mode">Mode</a></h2>
<p><code>wasm-pack new</code> mode å‚æ•°ç”¨æ¥æ§åˆ¶ <code>wasm-pack</code> ä¾èµ–å·¥å…·çš„å®‰è£…æ¨¡å¼:</p>
<pre><code class="language-sh">wasm-pack new myproject --mode noinstall
</code></pre>
<p>å¯é€‰å€¼ä¸º <code>normal</code>, <code>noinstall</code> å’Œ <code>force</code>ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ <code>normal</code></p>
<p><code>noinstall</code> æ„å‘³ç€ <code>wasm-pack</code> ä¸ä¼šå®‰è£…ä¾èµ–å·¥å…·ã€‚
å¦‚æœåœ¨ä½¿ç”¨ <code>wasm-pack</code> æ—¶æ‰¾ä¸åˆ°æ‰€éœ€çš„å·¥å…·ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p><code>force</code> æ„å‘³ç€ <code>wasm-pack</code> ä¸æ£€æŸ¥æœ¬åœ°çš„ Rust ç‰ˆæœ¬ã€‚
å¦‚æœæœ¬åœ°çš„ Rust ç‰ˆæœ¬ä¸ç¬¦åˆè¦æ±‚ï¼Œåœ¨è¿è¡Œ <code>wasm-pack</code> å‘½ä»¤æ—¶å°†æŠ¥é”™ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wasm-pack-build"><a class="header" href="#wasm-pack-build">wasm-pack build</a></h1>
<p><code>wasm-pack build</code> å‘½ä»¤å°†ä¼šç”Ÿæˆåœ¨ JavaScript ä¸­ä½¿ç”¨ wasm çš„èƒ¶æ°´æ–‡ä»¶ï¼Œä»¥åŠæ¨é€åˆ° npm ä»“åº“æ‰€éœ€çš„æ–‡ä»¶ã€‚</p>
<p><code>wasm-pack build</code> å‘½ä»¤å°†ä¼šåœ¨ pkg æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆï¼Œç¼–è¯‘åçš„ wasm äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒJavaScript èƒ¶æ°´æ–‡ä»¶ï¼Œä»¥åŠæ¨é€åˆ° npm ä»“åº“æ‰€éœ€çš„ package.json å’Œ README.md</p>
<p><code>pkg</code> æ–‡ä»¶å¤¹é»˜è®¤ä¼šåŒ…å«åœ¨ <code>.gitignore</code> ä¸­ï¼Œä¸ä¼šè¢« git å·¥å…·è·Ÿè¸ªã€‚</p>
<h2 id="path"><a class="header" href="#path">Path</a></h2>
<p><code>path</code> å¯ä»¥æŒ‡å®šå‘½ä»¤è¿è¡Œçš„æ–‡ä»¶å¤¹ï¼ˆéœ€è¦åŒ…å« Cargo.tomlï¼‰ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šçš„è¯ï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹è¿è¡Œå‘½ä»¤:</p>
<pre><code class="language-sh">wasm-pack build examples/js-hello-world
</code></pre>
<h2 id="è¾“å‡ºæ–‡ä»¶å¤¹"><a class="header" href="#è¾“å‡ºæ–‡ä»¶å¤¹">è¾“å‡ºæ–‡ä»¶å¤¹</a></h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>wasm-pack</code> ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªåä¸º <code>pkg</code> çš„æ–‡ä»¶å¤¹ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>--out-dir</code> å‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚:</p>
<p>By default, <code>wasm-pack</code> will generate a directory for it's build output called <code>pkg</code>.
If you'd like to customize this you can use the <code>--out-dir</code> flag.</p>
<pre><code class="language-sh">wasm-pack build --out-dir out
</code></pre>
<h2 id="æ–‡ä»¶åå‰ç¼€"><a class="header" href="#æ–‡ä»¶åå‰ç¼€">æ–‡ä»¶åå‰ç¼€</a></h2>
<p><code>--out-name</code> å¯ä»¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„å‰ç¼€ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œå°†ä¼šä½¿ç”¨å½“å‰é¡¹ç›®åä½œä¸ºå‰ç¼€ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬çš„ carte åå­—æ—¶ <code>dom</code> çš„è¯ï¼š</p>
<pre><code class="language-sh">wasm-pack build
# will produce files
# dom.d.ts  dom.js  dom_bg.d.ts  dom_bg.wasm  package.json  README.md

wasm-pack build --out-name index
# will produce files
# index.d.ts  index.js  index_bg.d.ts  index_bg.wasm  package.json  README.md
</code></pre>
<h2 id="profile"><a class="header" href="#profile">Profile</a></h2>
<p><code>build</code>å‘½ä»¤è¿˜èƒ½ä¿®æ”¹ç¼–è¯‘æ¨¡å¼ï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦å¯ç”¨è°ƒè¯•æ–­è¨€ï¼Œæ˜¯å¦ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼Œæ˜¯å¦å¯ç”¨ä¼˜åŒ–ã€‚ä¸‹é¢æ˜¯å„ä¸ªé…ç½®çš„åŒºåˆ«ï¼š</p>
<table><thead><tr><th>é…ç½®</th><th>è°ƒè¯•æ–­è¨€</th><th>è°ƒè¯•ä¿¡æ¯</th><th>ç¼–è¯‘ä¼˜åŒ–</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td><code>--dev</code></td><td>Yes</td><td>Yes</td><td>No</td><td>ç”¨äºå¼€å‘å’Œè°ƒè¯•</td></tr>
<tr><td><code>--profiling</code></td><td>No</td><td>Yes</td><td>Yes</td><td>ç”¨äºåˆ†ææ€§èƒ½é—®é¢˜</td></tr>
<tr><td><code>--release</code></td><td>No</td><td>No</td><td>Yes</td><td>ä¸€èˆ¬ç”¨äºå‘å¸ƒåˆ°ç”Ÿæˆç¯å¢ƒï¼Œè¿™ä¸ªæ—¶é»˜è®¤å€¼</td></tr>
</tbody></table>
<p><code>--dev</code>é…ç½®ç›¸å½“äºä½¿ç”¨ cargo çš„ <a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-profile-sections">default
non-release profile</a>ï¼Œç¼–è¯‘çš„é€Ÿåº¦å¾ˆå¿«ï¼Œä½†æ˜¯ä»£ç åŸºæœ¬ä¸Šä¸ä¼šè¢«ä¼˜åŒ–ï¼Œå¹¶ä¸”ä¼šå¯ç”¨è°ƒè¯•æ–­è¨€ï¼ˆ debug assertions ï¼‰å’Œè¿è¡Œæ—¶æ£€æµ‹ï¼ˆruntime correctness checksï¼‰ã€‚<code>--profiling</code>å’Œ<code>--release</code>é…ç½®ç›¸å½“äºä½¿ç”¨ cargo çš„ release é…ç½®ï¼Œ<code>--profiling</code>ä¹Ÿèƒ½å®ç°è°ƒè¯•ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ’æŸ¥æ€§èƒ½é—®é¢˜ã€‚</p>
<h2 id="target"><a class="header" href="#target">Target</a></h2>
<p><code>--target</code> å‚æ•°ç”¨æ§åˆ¶ç”Ÿæˆçš„èƒ¶æ°´ JS æ–‡ä»¶å¦‚ä½•åŠ è½½å’Œå®ä¾‹åŒ–<code>WebAssembly</code>ã€‚
å…³äºç”Ÿæˆå„ç§ç­–åˆ—è¯¦è§ä¸‹è¡¨å’Œ<a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html">documentation on using the compiled output</a>ã€‚</p>
<pre><code>wasm-pack build --target nodejs
</code></pre>
<table><thead><tr><th>å¯é€‰å€¼</th><th>ç›®æ ‡å¹³å°</th><th>æè¿°</th></tr></thead><tbody>
<tr><td>æœªæŒ‡å®šæˆ–è€…<code>bundler</code></td><td><a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html#bundlers">Bundler</a></td><td>ç”Ÿæˆ ES Module æ ¼å¼çš„ JS æ–‡ä»¶ã€‚ä¸»è¦é€‚ç”¨äº webpackã€rollup ç­‰æ‰“åŒ…å™¨ã€‚ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ <code>import</code> å…³é”®å­—ç›´æ¥å¼•å…¥ã€‚ä¼šåœ¨ <code>package.json</code> ç”Ÿæˆ <code>module</code> å­—æ®µå’Œ <code>sideEffects: false</code>ã€‚</td></tr>
<tr><td><code>nodejs</code></td><td><a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html#nodejs">Node.js</a></td><td>ç”Ÿæˆ CommonJS æ ¼å¼çš„ JS æ–‡ä»¶ï¼Œä¸»è¦ç”¨äº nodejsã€‚ä½¿ç”¨ <code>require</code>å…³é”®å­—å¼•å…¥ã€‚ä¼šåœ¨ <code>package.json</code> ä¸­ç”Ÿæˆ <code>main</code> å­—æ®µã€‚</td></tr>
<tr><td><code>web</code></td><td><a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html#without-a-bundler">Native in browser</a></td><td>ç”Ÿæˆå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨çš„ ESModule JS æ–‡ä»¶ï¼Œä½†æ˜¯ WebAssembly å¿…é¡»æ‰‹åŠ¨åŠ è½½å’Œå®ä¾‹åŒ–ã€‚</td></tr>
<tr><td><code>no-modules</code></td><td><a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html#without-a-bundler">Native in browser</a></td><td>å’Œ<code>web</code>ä¸€æ ·å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œä½†æ˜¯ç›´æ¥æ³¨å…¥åœ¨å…¨å±€å˜é‡ä¸­ï¼Œä¸æ”¯æŒ<code>wasm-bindgen</code>ä¸­çš„å¾ˆå¤šåŠŸèƒ½ã€‚</td></tr>
</tbody></table>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>ä¸»è¦ç”¨äºå‘å¸ƒåŒ…å« scope çš„ npm åŒ…ã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„å‘½ä»¤ä¼šè®©å¾—åˆ°<code>package.json</code>çš„<code>name</code>å­—æ®µä¸º<code>@test/js-hello-world</code>ï¼Œåœ¨ npm çš„æ–‡æ¡£ä¸­äº†è§£<a href="https://docs.npmjs.com/misc/scope">æ›´å¤š</a>ã€‚</p>
<pre><code>wasm-pack build examples/js-hello-world --scope test
</code></pre>
<h2 id="mode-1"><a class="header" href="#mode-1">Mode</a></h2>
<p><code>--model</code>ç”¨æ¥æ§åˆ¶æ˜¯å¦å®‰è£…<code>wasm-bindgen</code>ã€‚</p>
<pre><code>wasm-pack build examples/js-hello-world --mode no-install
</code></pre>
<table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody>
<tr><td><code>no-install</code></td><td><code>wasm-pack init</code> ä¸ä¼šå®‰è£… <code>wasm-bindgen</code>.</td></tr>
<tr><td><code>normal</code></td><td>ä¼šå®‰è£… <code>wasm-bindgen</code>.</td></tr>
</tbody></table>
<h2 id="é¢å¤–å‚æ•°"><a class="header" href="#é¢å¤–å‚æ•°">é¢å¤–å‚æ•°</a></h2>
<p><code>build</code> å‘½ä»¤ä¸æ”¯æŒé™¤äº†ä¸Šé¢å¤–çš„å…¶ä»–å‚æ•°ã€‚å¦‚æœä½ æƒ³ç»™ <code>cargo build</code> ä¼ é€’å‚æ•°ï¼Œå¯ä»¥åœ¨å‘½ä»¤æœ€åé™„åŠ ä¸Šéœ€è¦ä¼ é€’çš„å‚æ•°ã€‚</p>
<p>ä¾‹å¦‚è¦ä½¿ç”¨ <code>cargo</code> çš„ç¦»çº¿åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code>wasm-pack build examples/js-hello-world --mode no-install -- --offline
</code></pre>
<hr style="font-size: 1.5em; margin-top: 2.5em"/>
<p><sup id="footnote-0">0</sup> ç›®å‰è¿˜ä¸æ”¯æŒåœ¨ pkg æ–‡ä»¶å¤¹æˆ–è€… npm åŒ…ä¸­åŒ…å«å…¶ä»–é¢å¤–çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šå°½å¿«æ¨å‡ºè§£å†³æ–¹æ¡ˆã€‚ <a href="commands/build.html#wasm-pack-build">â†©</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wasm-pack-test"><a class="header" href="#wasm-pack-test">wasm-pack test</a></h1>
<p><code>wasm-pack test</code>å‘½ä»¤æ˜¯å¯¹<a href="https://rustwasm.github.io/wasm-bindgen/wasm-bindgen-test/index.html">wasm-bindgen-test-runner</a> CLI çš„å°è£…ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»–åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸­æ¥æµ‹è¯•ä½ çš„ wasm æ¨¡å—ï¼Œä¸”ä¸éœ€è¦ä½ åœ¨å³å®‰è£…å„ç§ WebDriverã€‚</p>
<pre><code>wasm-pack test --help
</code></pre>
<h2 id="path-1"><a class="header" href="#path-1">Path</a></h2>
<p><code>wasm-pack test</code> å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‚æ•°æ¥æŒ‡å®šè¦æµ‹è¯•çš„ <code>crate</code> æ–‡ä»¶å¤¹ï¼Œé»˜è®¤æ˜¯å½“å‰ç›®å½•ã€‚æŒ‡å®šçš„æ–‡ä»¶å¤¹éœ€è¦åŒ…å« <code>Cargo.toml</code></p>
<pre><code># ä¸ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ crate è¿è¡Œæµ‹è¯•
wasm-pack test

# ä¸ºæŒ‡å®šç›®å½•ä¸‹çš„ crate è¿è¡Œæµ‹è¯•
wasm-pack test crates/crate-in-my-workspace
</code></pre>
<h2 id="profile-1"><a class="header" href="#profile-1">Profile</a></h2>
<p><code>test</code>å‘½ä»¤å¯ä»¥æŒ‡å®šä½¿ç”¨ <code>--release</code> æ„å»ºï¼Œå¦‚æœæ²¡æŒ‡å®šçš„è¯ä¼šç”Ÿæˆä¸€ä¸ª <code>--debug</code> çš„æ„å»ºã€‚</p>
<h2 id="æµ‹è¯•ç¯å¢ƒ"><a class="header" href="#æµ‹è¯•ç¯å¢ƒ">æµ‹è¯•ç¯å¢ƒ</a></h2>
<p>é€šè¿‡æŒ‡å®šæµ‹è¯•ç¯å¢ƒæ ‡å¿—æ¥ç»„åˆè¿è¡Œæµ‹è¯•çš„ç¯å¢ƒã€‚</p>
<p>å¯¹äºæŒç»­é›†æˆæ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ <code>--headless</code> æ¥è¿è¡Œä¸€ä¸ªæ— å¤´æµè§ˆå™¨(headless browser)ã€‚</p>
<pre><code>wasm-pack test --node --firefox --chrome --safari --headless
</code></pre>
<h2 id="é¢å¤–å‚æ•°-1"><a class="header" href="#é¢å¤–å‚æ•°-1">é¢å¤–å‚æ•°</a></h2>
<p>å’Œ<code>build</code>å‘½ä»¤ä¸€æ ·ï¼Œ<code>test</code> ä¹Ÿç»™ <code>cargo test</code> ä¼ é€’é¢å¤–çš„å‚æ•°ï¼Œåªéœ€è¦åœ¨å‘½ä»¤çš„åé¢åŠ ä¸Šéœ€è¦çš„å‚æ•°å°±è¡Œã€‚</p>
<p>ä½¿ç”¨ <code>cargo test -h</code> æŸ¥çœ‹ <code>cargo test</code> çš„é¢å¤–å‚æ•°ã€‚</p>
<h2 id="è¿è¡Œä¸€éƒ¨åˆ†æµ‹è¯•"><a class="header" href="#è¿è¡Œä¸€éƒ¨åˆ†æµ‹è¯•">è¿è¡Œä¸€éƒ¨åˆ†æµ‹è¯•</a></h2>
<p>å½“è°ƒè¯•ç‰¹å®šé—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥è¿è¡Œä¸€éƒ¨åˆ†æµ‹è¯•ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæµ‹è¯•ä»£ç ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œç”¨æ¥è¯´æ˜å¦‚ä½•åªå…è®¸è¿è¡Œä¸€éƒ¨åˆ†æµ‹è¯•ã€‚</p>
<pre><code>$ tree crates/foo
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ README.md
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ diff
â”‚   â”‚   â”œâ”€â”€ diff_test_case.rs
â”‚   â”‚   â””â”€â”€ mod.rs
â”‚   â”œâ”€â”€ lib.rs
â””â”€â”€ tests
    â”œâ”€â”€ diff_patch.rs
    â””â”€â”€ node.rs
</code></pre>
<pre><code># åœ¨ FireFox ä¸­è¿è¡Œ tests/diff_patch.rs æ–‡ä»¶çš„æ‰€æœ‰æµ‹è¯•
wasm-pack test crates/foo --firefox --headless --test diff_patch

# è¿è¡Œtests/diff_patch.rsæ–‡ä»¶ä¸­ï¼Œåå­—åŒ…å« &quot;replace&quot; çš„æµ‹è¯•
wasm-pack test crates/foo --firefox --headless --test diff_patch replace

# è¿è¡Œ src/lib/diff.rs æ–‡ä»¶ä¸­ï¼Œ`tests` æ¨¡å—çš„æµ‹è¯•
wasm-pack test crates/foo --firefox --headless --lib diff::tests

# å’Œä¸Šé¢ä¸€æ ·ï¼Œä½†æ˜¯åªè¿è¡ŒåŒ…å« &quot;replace&quot; çš„æµ‹è¯•
wasm-pack test crates/foo --firefox --headless --lib diff::tests::replace
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pack-å’Œ-publish"><a class="header" href="#pack-å’Œ-publish">pack å’Œ publish</a></h1>
<p>è¿™ 2 ä¸ªå‘½ä»¤æ˜¯ npm åŒåå‘½ä»¤çš„æ›¿ä»£å“ï¼Œä¸»è¦æ˜¯åœ¨ä¸å®‰è£… nodejs çš„æƒ…å†µä¸‹ä½¿ç”¨æ‰“åŒ… npm åŒ…å’Œå‘å¸ƒ npm åŒ…ã€‚</p>
<p><code>pack</code>å‘½ä»¤ç”¨æ¥ä» pkg æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª npm åŒ…ï¼Œå°±æ˜¯ä¸€ä¸ª zip æ–‡ä»¶ã€‚</p>
<p><code>publish</code>å‘½ä»¤ç”¨æ¥å°† pkg æ–‡ä»¶æ¨é€åˆ° npm ä»“åº“ã€‚</p>
<p>å¯ä»¥åœ¨ä¸‹é¢ 2 ä¸ª npm æ–‡æ¡£ä¸­è·å–åˆ°å‘½ä»¤çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<ul>
<li><a href="https://docs.npmjs.com/cli/pack"><code>npm pack</code></a></li>
<li><a href="https://docs.npmjs.com/cli/publish"><code>npm publish</code></a></li>
</ul>
<p>é€šå¸¸æƒ…å†µä¸‹è¿™ 2 ä¸ªå‘½ä»¤éƒ½ä¼šä½¿ç”¨ pkg æ–‡ä»¶å¤¹ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–æ–‡ä»¶å¤¹ï¼ˆéœ€è¦æ˜¯ pkg æ–‡ä»¶å¤¹æˆ–è€… pkg æ–‡ä»¶å¤¹çš„çˆ¶æ–‡ä»¶å¤¹ï¼‰ã€‚</p>
<pre><code>$ wasm-pack pack myproject/pkg
| ğŸ’  packed up your package!
$ wasm-pack pack myproject
| ğŸ’  packed up your package!
</code></pre>
<p>å¦‚æœä½ æŒ‡å®šäº†ä¸€ä¸ªä¸ç¬¦åˆè¦æ±‚çš„è·¯å¾„ï¼Œä¼šå¾—åˆ°æŠ¥é”™ï¼š</p>
<pre><code>$ wasm-pack pack myproject/src/
Unable to find the pkg directory at path 'myproject/src/', or in a child directory of 'myproject/src/'
</code></pre>
<p>å¦‚æœä½ ä¸æŒ‡å®šè·¯å¾„ï¼Œå°±ä¼šä½¿ç”¨å½“å‰æ–‡ä»¶å¤¹ã€‚</p>
<h2 id="æ¨é€ä¸€ä¸ªåŒ…å«-tag-çš„åŒ…"><a class="header" href="#æ¨é€ä¸€ä¸ªåŒ…å«-tag-çš„åŒ…">æ¨é€ä¸€ä¸ªåŒ…å« Tag çš„åŒ…</a></h2>
<p>ä½¿ç”¨ <code>--tag</code> å‚æ•°å¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…çš„ tagï¼Œä¾‹å¦‚ï¼š</p>
<pre><code>wasm-pack publish --tag next
</code></pre>
<p>é»˜è®¤æƒ…å†µä¸‹æ˜¯ä½¿ç”¨ <code>latest</code> tagã€‚åœ¨ npm çš„æ–‡æ¡£ä¸Šäº†è§£æ›´å¤šå…³äº <a href="https://docs.npmjs.com/cli/dist-tag">Tag çš„ä¿¡æ¯</a>ã€‚</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
